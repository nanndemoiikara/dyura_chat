function ClientChat(a){this.connect_url=a.socket_url||"http://localhost:8214",this.name=a.username||"セットン",this.color=a.color||"gray",this.sendButton=document.getElementById("send_message"),this.inputBox=this.sendButton.previousElementSibling,this.messageBox=document.getElementById("chat_body"),this.io,this.__construct()}ClientChat.prototype.__construct=function(){var a=this;this.io=io.connect(this.connect_url),this.eventHandler(),this.sendButton.addEventListener("click",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1,a.addMessage()},!1),this.io.emit("connection",this.name,this.color)},ClientChat.prototype.eventHandler=function(){this.io.on("getMessage",this.getMessage.bind(this))},ClientChat.prototype.getMessage=function(a){var b=document.createDocumentFragment(),c=document.createElement("DIV"),d=document.createElement("P"),e=this;if(c.className="system_message",a.sysMsg===!1){var f=document.createElement("A");f.href="#"+a.id,f.className="user_icon",f.appendChild(document.createTextNode(a.name)),c.appendChild(f),d.appendChild(document.createTextNode(a.value)),c.className="chat_message "+a.color}else d.innerHTML=a.value;c.appendChild(d);var g=c.getElementsByClassName("user_icon");g.length>0&&g[0].addEventListener("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;var b=this.getAttribute("href").replace("#","@");e.inputBox.value=b+" "+e.inputBox.value},!1),b.appendChild(c),this.messageBox.insertBefore(b,this.messageBox.firstChild)},ClientChat.prototype.addMessage=function(){if("INPUT"===this.inputBox.tagName&&""!=this.inputBox.value){var a=this.inputBox.value;this.io.emit("sendMessage",a),this.inputBox.value=""}},document.addEventListener("DOMContentLoaded",function(){new ClientChat(default_data)},!1);